const domify=(...e)=>document.body?document.body.domify(...e):window.addEventListener("load",()=>domify(...e));Element.prototype.domify=Element.prototype.modify=function(e,...t){if([null,void 0].includes(e))return;let i=t.filter(e=>"string"==typeof e)[0];if(["tag","id","onready","onReady"].includes(i))return;if("string"==typeof e&&e.endsWith(".json"))return domload(e,e=>this.domify(e,...t),t=>console.log(e,"Could not load JSON file."));const n=isPrimitive(e),o="function"==typeof e,s=Array.isArray(e);if(!o&&e.bind)return window[e.bind]||(window[e.bind]=new Bind),window[e.bind].bind(this,i,e.onvalue),void(void 0!==e.value&&(window[e.bind].value=e.value));const r=this.tagName.toLowerCase(),l="head"===r,a=t.filter(e=>"boolean"==typeof e)[0];let d=t.filter(e=>e&&e.tagName)[0];if(d)return d.domify(e,i,a,c);let c=t.filter(e=>e&&e.elt)[0];const f=!1===a;if(!i){return a&&(this.innerHTML=""),(f?Object.keys(e).reverse():Object.keys(e)).forEach(t=>this.domify(e[t],t,c,!f&&void 0)),this}if("style"===i){if(s)return e.forEach(e=>this.domify(e,i));if(!(l||e.lang||e.content))return n?this.setAttribute(i,e):(a&&(this.style=""),Object.keys(e).forEach(t=>this.style[t]=e[t]));if(i="styleSheet",!n){if(!e.content||isPrimitive(e.content))return this.domify(domifyCSS(e),i);e.content=domifyCSS(e.content)}}if("meta"!==r&&["content","html","innerHTML"].includes(i))return n?this.innerHTML=e:this.domify(e,!0);if(["text","innerText"].includes(i))return this.innerText=e;if(s){if("class"===i)return e.forEach(e=>e?this.classList.add(e):null);if("addEventListener"===i)return this.addEventListener(...e)}else if(o){if(void 0!==this[i])return void(this[i]=e);if(c&&"function"==typeof c[i])return c[i](e)}else if(n){if(l){let t="string"==typeof e?e.split(".").slice(-1)[0]:"none";if("title"===i)return this.innerHTML+=`<${i}>${e}</${i}>`;if("link"===i){let i={none:"",css:"css",sass:"sass",scss:"scss",ico:"icon"};return this.innerHTML+=`<link href="${e}" rel="${i[t]}">`}if("script"===i&&"js"===t)return this.innerHTML+=`<script src="${e}"<\/script>`}let t=void 0!==this.style[i]?this.style[i]=e:void 0;if(HTML_ATTRIBUTES.includes(i)&&(this.setAttribute(i,e),t=!0),void 0!==t)return}"styleSheet"===i&&(i="style");let[p,...m]=i.split("_"),u=m[0];i.includes(".")&&(m=i.split("."),p=m.shift()),p.includes("#")&&([p,u]=p.split("#")),p=e.tag?e.tag:p;let y=!(!e.tagName&&!e.elt)&&e;if(y||(p&&HTML_TAGS.includes(p.toLowerCase())||(u=p,p="div"),s?y=e.map(e=>this.domify(e,[p,...m].join("."),c)):(y=c?createElement(p):document.createElement(p),n?(c?y.elt:y).innerHTML=e:Object.keys(e).map(t=>y.domify(e[t],t,c)))),d=c?y.elt:y,(u=e.id?e.id:u)&&(s||d.setAttribute("id",u),window[u]=y),s)return;m&&m.forEach(e=>e?d.classList.add(e):null);let h=e.onready?e.onready:e.onReady;return h&&h(y),this[f?"prepend":"append"](d),y};const HTML_ATTRIBUTES=["accept","accept-charset","accesskey","action","align","alt","async","autocomplete","autofocus","autoplay","bgcolor","border","charset","checked","cite","class","color","cols","colspan","content","contenteditable","controls","coords","data","datetime","default","defer","dir","dirname","disabled","download","draggable","enctype","for","form","formaction","headers","height","hidden","high","href","hreflang","http-equiv","id","ismap","kind","lang","list","loop","low","max","maxlength","media","method","min","multiple","muted","name","novalidate","open","optimum","pattern","placeholder","poster","preload","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","selected","shape","size","sizes","spellcheck","src","srcdoc","srclang","srcset","start","step","style","tabindex","target","title","translate","type","usemap","value","wrap","width"],HTML_TAGS=["h1","h2","h3","h4","h5","h6","main","a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","datalist","dd","del","dfn","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","frame","frameset","head","header","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","map","mark","meta","meter","menu","nav","noscript","object","ol","optgroup","option","p","param","pre","progress","q","s","samp","script","section","select","small","source","span","strike","strong","style","sub","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","u","ul","var","video","wbr"],PSEUDO_CLASSES=["active","checked","disabled","empty","enabled","first-child","first-of-type","focus","hover","in-range","invalid","last-of-type","link","only-of-type","only-child","optional","out-of-range","read-only","read-write","required","root","target","valid","visited","lang","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type"],PSEUDO_ELEMENTS=["after","before","first-letter","first-line","selection"];String.prototype.camelCase=function(e=!1){return e?this.replace(/([A-Z])/g,e+"$1").toLowerCase():this.replace(/^([A-Z])|[\s-_ ]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase())};const isPrimitive=e=>["boolean","number","string"].includes(typeof e),assignAll=(e={},t={})=>((Array.isArray(e)?e:[e]).forEach(e=>Object.assign(t,e)),t),domifyCSS=(e,t)=>{if("string"!=typeof e){if(!e)return;return Array.isArray(e)&&(e=assignAll(e)),Object.keys(e).map(t=>domifyCSS(t,e[t])).join(" ")}let i,n,o=[];if([e,i,...n]=e.split("_"),i&&(e+="#"+i),n.length&&(e+="."+n.join(".")),isPrimitive(t))return`${e.camelCase("-")}: ${t};`;Array.isArray(t)&&(t=assignAll(t));let s=Object.keys(t).map(i=>{let n=t[i];if(isPrimitive(n))return domifyCSS(i,n);let s=i.split("(")[0].camelCase("-"),r=`${e} ${i}`;PSEUDO_CLASSES.includes(s)?r=`${e}:${i}`:PSEUDO_ELEMENTS.includes(s)?r=`${e}::${i}`:n.immediate&&(r=`${e}>${i}`),o.push(domifyCSS(r,n))}).join(" ");return(s?`\n${e} {${s}} `:"")+o.join(" ")};"undefined"!=typeof p5&&(p5.domify=((...e)=>domify(...e,createDiv())),p5.Element.prototype.domify=p5.Element.prototype.modify=function(...e){this.elt.domify(...e,this)});const dombind=(e,t,i)=>{const n="function"==typeof t;return{bind:e,onvalue:n?t:i,value:n?i:t}};class Bind{constructor(e=""){this._elems=[],this._value=e}bind(e,t="value",i=(e=>e)){this._elems.push({elem:e,property:t,onvalue:i}),e.domify(i(this._value),t)}set value(e){this._value=e,this._elems.forEach(t=>t.elem.domify(t.onvalue(e),t.property))}get value(){return this._value}}const domload=(e,t,i=(e=>null),n=(e=>null))=>{const o=!1===t;"function"==typeof t&&(n=i,i=t,t={});let s=new XMLHttpRequest;s.onreadystatechange=(e=>{if(4==s.readyState&&"200"==s.status)try{i(JSON.parse(s.responseText))}catch(e){i(s.responseText)}else n(s.status)}),s.open(o?"POST":"GET",e,!0),s.send(t)};domload("ini.json",e=>dominify(e,!0),e=>404===e?dominify(!1,!0):null);let dominify=(e,t=!1)=>{const i=e=>Array.isArray(e)?e:[e];let n=Object.assign({title:"A Domified Site",viewport:"width=device-width, initial-scale=1.0",charset:"UTF-8",icon:"assets/icon.ico",meta:[],resetCSS:!0,style:[],link:[],library:[],script:[],entryPoint:"main.js",module:!0,postscript:[]},isPrimitive(e)?{}:e);if(e){let t={"*":{boxSizing:"border",font:"inherit",fontFamily:"Arial, Helvetica, sans-serif",fontSize:"100%",fontStyle:"none",verticalAlign:"baseline",lineHeight:"1.5em",margin:0,padding:0,border:0,borderSpacing:0,borderCollapse:"collapse",listStyle:"none",quotes:"none",content:"",content:"none"}};e&&document.head.domify({title:n.title,meta:[{charset:n.charset},{name:"viewport",content:n.viewport},...i(n.meta)],link:[{rel:"icon",href:n.icon},...i(n.link)],script:i(n.script),style:[n.resetCSS?t:null,...i(n.style)]},!0)}t&&domload(e?n.entryPoint:"main.js",e=>{domify({script:[{type:n.module?"module":null,src:n.entry?n.entry:n.entryPoint},...i(n.postscript)]})})};
